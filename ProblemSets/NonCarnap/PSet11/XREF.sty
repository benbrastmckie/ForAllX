 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%% BEGIN XREF MACROS
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 	%This idea is lifted from David Salomon, The Advanced TeXbook.
	%It uses the example counter and creates a file of macros
	%tempmacros.tex which are read by the \eref macro.
	%RH Thomason

  \newread\exrefs
  \immediate\openin\exrefs=tempmacs.tex
  \ifeof\exrefs \message{! No file tempmacs.tex;}
  \else\input tempmacs.tex \immediate\closein\exrefs \fi
  \newwrite\exrefs
  \immediate\openout\exrefs=tempmacs.tex

  \def\elabel#1{\immediate\write\exrefs
   {\noexpand\def\expandafter\noexpand\csname#1\endcsname{\theexample}}}
  \def\eref#1{%
  \if undefined{#1}\message{! No ref to #1;}%
  \else\csname #1\endcsname\fi}
 
  \newread\mthmvrefs
  \immediate\openin\mthmvrefs=mthmvmac.tex
  \ifeof\mthmvrefs \message{! No file mthmvmac.tex;}
  \else\input mthmvmac.tex \immediate\closein\mthmvrefs \fi
  \newwrite\mthmvrefs
  \immediate\openout\mthmvrefs=mthmvmac.tex

  \def\mvlabel#1{\immediate\write\mthmvrefs
   {\noexpand\def\expandafter\noexpand\csname#1\endcsname{\themetathm}}}
  \def\mvref#1{%
  \if undefined{#1}\message{! No ref to #1;}%
  \else\csname #1\endcsname\fi}
 
  \newread\mthmviirefs
  \immediate\openin\mthmviirefs=mthmviimac.tex
  \ifeof\mthmviirefs \message{! No file mthmviimac.tex;}
  \else\input mthmviimac.tex \immediate\closein\mthmviirefs \fi
  \newwrite\mthmviirefs
  \immediate\openout\mthmviirefs=mthmviimac.tex

  \def\mviilabel#1{\immediate\write\mthmviirefs
   {\noexpand\def\expandafter\noexpand\csname#1\endcsname{\themetathm}}}
  \def\mviiref#1{%
  \if undefined{#1}\message{! No ref to #1;}%
  \else\csname #1\endcsname\fi}
 
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%% END XREF MACROS
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%   \newread\enuirefs
%   \immediate\openin\enuirefs=tempeni.tex
%   \ifeof\enuirefs \message{! No file tempeni.tex;}
%   \else\input tempeni.tex \immediate\closein\enuirefs \fi
%   \newwrite\enuirefs
%   \immediate\openout\exrefs=tempeni.tex
% 
%   \def\enumilabel#1{\immediate\write\enuirefs
%    {\noexpand\def\expandafter\noexpand\csname#1\endcsname{\theexample}}}
%   \def\enumiref#1{%
%   \if undefined{#1}\message{! No ref to #1;}%
%   \else\csname #1\endcsname\fi}
%  
% 
% 

\newcounter{tempexample}


\newcommand{\setenumi}{
 \setcounter{tempexample}{\value{example}}
 \setcounter{example}{\value{enumi}}
}

\newcommand{\resetenumi}{
   \setcounter{example}{\value{tempexample}}
 }

\newcommand{\enumilabel}[1]{\setenumi #1\resetenumi}